<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>나노 원격 컴퓨터 임대</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- 헤더 배너 -->
  <header class="banner">
    <img src="images/hd.png" alt="나노 원격 임대 배너">
  </header>

  <!-- 공지사항 -->
  <section class="notice">
    <div class="notice-box">
      <h2>공지사항</h2>
      <p>공지사항 내용을 여기에 입력하세요.</p>
    </div>
  </section>

  <!-- 옵션 영역 -->
  <section class="options">
    <div class="option-box">
      <img src="images/option1.jpg" alt="옵션1">
      <div class="stock-box" id="stock1">현재 임대 가능 대수 : <span class="count">불러오는 중...</span></div>
    </div>
    <div class="option-box">
      <img src="images/option2.jpg" alt="옵션2">
      <div class="stock-box" id="stock2">현재 임대 가능 대수 : <span class="count">불러오는 중...</span></div>
    </div>
    <div class="option-box">
      <img src="images/option3.jpg" alt="옵션3">
      <div class="stock-box" id="stock3">현재 임대 가능 대수 : <span class="count">불러오는 중...</span></div>
    </div>
  </section>

  <!-- 갤러리 -->
  <section class="gallery">
    <div class="gallery-item"><img src="images/img1.png" alt="갤러리 이미지1"></div>
    <div class="gallery-item"><img src="images/img2.png" alt="갤러리 이미지2"></div>
    <div class="gallery-item"><img src="images/gallery3.png" alt="갤러리 이미지3"></div>
    <div class="gallery-item"><img src="images/gallery4.png" alt="갤러리 이미지4"></div>
  </section>

  <!-- 플로팅 버튼 -->
  <div class="floating-buttons">
    <a href="https://open.kakao.com" target="_blank" class="btn kakao">
      <img src="images/kakao.png" alt="카카오 로고"> 카카오톡
    </a>
    <a href="https://t.me/yourtelegram" target="_blank" class="btn telegram">
      <img src="images/telegram.png" alt="텔레그램 로고"> 텔레그램
    </a>
  </div>

  <!-- 스크립트: 구글 시트 데이터 불러오기 -->
  <script>
    const sheetId = "1vwCFM0exXmgkN5vz06IA9j4LJxa95oeqtd-ew5cJFVc";
    const baseUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=Sheet1&tq=`;

    function fetchData(col, targetId) {
      fetch(baseUrl + `select%20${col}`)
        .then(res => res.text())
        .then(text => {
          const json = JSON.parse(text.substring(text.indexOf("{"), text.lastIndexOf("}") + 1));
          const value = json.table.rows[0]?.c[0]?.v;
          document.querySelector(`#${targetId} .count`).innerText = value ? `${value}대` : "데이터 없음";
        })
        .catch(() => {
          document.querySelector(`#${targetId} .count`).innerText = "불러오기 실패";
        });
    }

    fetchData("A", "stock1");
    fetchData("B", "stock2");
    fetchData("C", "stock3");
  </script>
</body>
</html>
